"use strict";const WPFormsAuthorizeNet=window.WPFormsAuthorizeNet||function(e,n){let r;const i={init:function(){n(e).on("wpformsReady",i.updateSubmitHandler).on("wpformsBeforePageChange",i.pageChange),n(i.ready)},ready:function(){i.loadValidation()},updateSubmitHandler:function(){void 0!==n.fn.validate&&n(".wpforms-authorize_net form").filter((e,a)=>"number"==typeof n(a).data("formid")).each(function(){var e=n(this).data("validator");if(!e)return!0;r=e.settings.submitHandler,e.settings.submitHandler=i.submitHandler})},submitHandler:function(e){const a=n(e);e=a.data("validator");if(!(e&&0<e.numberOfInvalids())&&!i.isFieldFilled(a))r(a);else{i.disableSubmitBtn(a),i.removeErrorMessages(a);const t=i.getCardData(a);e=i.getAuthData();Accept.dispatchData({cardData:t,authData:e},function(e){i.apiResponseHandler(a,e,t)})}},pageChange:function(a,e,t,r){var n=t.find(".wpforms-field-authorize_net");"prev"!==r&&n.is(":visible")&&(n.data("required")||i.isFieldFilled(t))&&(i.removeErrorMessages(t),r=i.getAuthData(),n=i.getCardData(t),Accept.dispatchData({cardData:n,authData:r},function(e){"Error"===e.messages.resultCode&&(i.displayApiErrorMessage(t,e.messages.message),a.preventDefault())}))},isFieldFilled:function(e){e=i.getCardData(e);return e.cardNumber||e.cardCode||e.year||e.month},getCardData:function(e){return{cardNumber:e.find(".wpforms-field-authorize_net-cardnumber").val().replace(/\s+/g,""),month:e.find(".wpforms-field-authorize_net-cardmonth").val()||"",year:e.find(".wpforms-field-authorize_net-cardyear").val()||"",cardCode:e.find(".wpforms-field-authorize_net-cardcvc").val()}},getAuthData:function(){return{clientKey:wpforms_authorize_net.public_client_key,apiLoginID:wpforms_authorize_net.api_login_id}},apiResponseHandler:function(e,a,t){"Error"===a.messages.resultCode?(i.displayApiErrorMessage(e,a.messages.message),i.enableSubmitBtn(e)):(e.append('<input type="hidden" name="wpforms[authorize_net][opaque_data][descriptor]" value="'+i.escapeTextString(a.opaqueData.dataDescriptor)+'">'),e.append('<input type="hidden" name="wpforms[authorize_net][opaque_data][value]" value="'+i.escapeTextString(a.opaqueData.dataValue)+'">'),e.append('<input type="hidden" name="wpforms[authorize_net][card_data][expire]" value="'+i.escapeTextString(t.month+"/"+t.year)+'">'),i.submitForm(e))},disableSubmitBtn:function(e){e.find(".wpforms-submit").prop("disabled",!0)},enableSubmitBtn:function(e){e.find(".wpforms-submit").prop("disabled",!1)},displayApiErrorMessage:function(e,a){var e=e.find(".wpforms-field-authorize_net"),t=n('<div class="wpforms-error-alert wpforms-error-authorize-net"></div>'),r=a.length;for(let e=0;e<r;e++)t.append("<p>"+i.escapeTextString(a[e].text)+"</p>"),console.log("%cWPForms Authorize.Net Debug: ","color: #cd6622;",a[e].code+": "+a[e].text);e.append(t)},removeErrorMessages:function(e){e.find(".wpforms-error-authorize-net").remove(),e.find(".wpforms-error-container").remove()},submitForm:function(e){e.data("validator")&&r(e)},loadValidation:function(){void 0!==n.fn.payment&&(n(".wpforms-field-authorize_net-cardnumber").payment("formatCardNumber"),n(".wpforms-field-authorize_net-cardcvc").payment("formatCardCVC"))},escapeTextString:function(e){return n("<span></span>").text(e).html()}};return i}(document,(window,jQuery));WPFormsAuthorizeNet.init();